<!DOCTYPE html>
<!--
La estructura del programa debe incluir:

Un componente del cuadrado que puedes mover para jugar (0.5)
Un componente de la puntuación (1)
Una función que define el área de bloques donde se puede matar al jugador (incluye la creación de espacios aleatorios al principio y después de x milisegundos) (2)
Una función que evalúa si ha habido contacto entre los bloques y la casilla del jugador (2)
Una función que actualiza la posición del cuadrado de acuerdo con su posición anterior, su velocidad y su aceleración (1)
Una función que comprueba si hemos llegado a la parte inferior o superior del lienzo (0.5)

-----EXTRA------

Puede agregar 4 direcciones en lugar de solo dos (4 controles de teclado, superior, derecha, izquierda e inferior) (1)
Puedes elegir cómo ganar vida o cómo terminar el juego de forma progresiva (1)
Puedes agregar otro jugador que se mueva de manera diferente al primero (1)

-->
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game</title>
</head>
<!-- Info para crear juegos -->
<!--https://juegoscanvas.blogspot.com/-->

<!--juego del ping pong-->
<!--https://developer.mozilla.org/es/docs/Games/Tutorials/2D_Breakout_game_pure_JavaScript-->

<body>
    <canvas id="canvas" width="930" height="400"></canvas>

    <script>
        var canvas = document.getElementById("canvas");
        var context = canvas.getContext("2d");

        //Variables X e Y
        var x = canvas.width / 2;
        var y = canvas.height - 30;
        //Variables para el movimiento por las cordenadas X e Y
        var dx = 2;
        var dy = -2;

        //Radio de la pelota
        var radioBall = 10;

        //Tamaño del rectangulo
        var rectAlto = 30;
        var rectAncho = 75;

        //Posicion por el eje X
        var rectX = (canvas.width - rectAncho / 2);

        //Teclas
        var der = false;
        var izq = false;


        //Estos dos event listener cogeran cuando presione o no presione las teclas
        document.addEventListener("keydown", SinPresionar, false);
        document.addEventListener("keyup", Presionada, false);

        function SinPresionar(tecla) {
            if (tecla.keyCode == 39) {
                der = false;
            } else if (tecla.keyCode == 37) {
                izq = false;
            }
        }

        function Presionada(tecla) {
            if (tecla.keyCode == 39) {
                der == true;
            } else if (tecla.keyCode == 37) {
                izq = true;
            }
        }

        //funcion la cual nos creara la bola
        function crearBall() {
            //Esto borra el lienzo antes de cada fotograma
            context.beginPath();
            context.arc(x, y, radioBall, 0, Math.PI * 2);
            context.fillStyle = "darkorange";
            context.fill();
            context.closePath();

        }

        //funcion la cual nos crea el rectangulo
        function crearRect() {
            context.beginPath();
            //Dibuja el rectangulo a lo largo del eje X
            context.rect(rectX, canvas.height - rectAlto, rectAlto, rectAncho);
            context.fillStyle = "orange";
            context.fill();
            context.closePath();
        }

        //funcion la cual nos movera la bola
        function mover() {
            context.clearRect(0, 0, canvas.width, canvas.height);

            crearBall();
            crearRect();

            //Condicion la cual permite que la bola rebote al llegar a las paredes
            if (x + dx > canvas.width - radioBall || x + dx < radioBall) {
                dx = -dx;
            }
            if (y + dy > canvas.height - radioBall || y + dy < radioBall) {
                dy = -dy
            }

            if (der && rectX < canvas.width - rectAncho) {
                rectX += 7
            } else if (izq && rectX > 0)  {
                rectX -= 7;
            }

            x += dx;
            y += dy;
           
        }

        // Hace un intervalo de la funcion pasada por parametro a los milisegundos puestos
        // me repite la funcion infinitamente a la velocidad que le diga
        setInterval(mover, 10);
    </script>

</body>

</html>